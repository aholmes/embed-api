<!DOCTYPE html>
<html>
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>The source code</title>
  <link href="../resources/prettify/prettify.css" type="text/css" rel="stylesheet" />
  <script type="text/javascript" src="../resources/prettify/prettify.js"></script>
  <style type="text/css">
    .highlight { display: block; background-color: #ddd; }
  </style>
  <script type="text/javascript">
    function highlight() {
      document.getElementById(location.hash.replace(/#/, "")).className = "highlight";
    }
  </script>
</head>
<body onload="prettyPrint(); highlight();">
  <pre class="prettyprint lang-js">/*!
  * domready (c) Dustin Diaz 2012 - License MIT
  */
(function(scope, definition) {
    if (!scope.initialized) {
        // usage: MTVNPlayer.module(&quot;domready&quot;).on(callback);
        scope.on = definition();
    }
    scope.initialized = true;
})(window.MTVNPlayer.module(&quot;domready&quot;), function(ready) {

    var fns = [],
        fn, f = false,
        doc = document,
        testEl = doc.documentElement,
        hack = testEl.doScroll,
        domContentLoaded = 'DOMContentLoaded',
        addEventListener = 'addEventListener',
        onreadystatechange = 'onreadystatechange',
        readyState = 'readyState',
        loaded = /^loade|c/.test(doc[readyState])

        function flush(f) {
            loaded = 1
            while (f = fns.shift()) f()
        }

    doc[addEventListener] &amp;&amp; doc[addEventListener](domContentLoaded, fn = function() {
        doc.removeEventListener(domContentLoaded, fn, f)
        flush()
    }, f)


    hack &amp;&amp; doc.attachEvent(onreadystatechange, fn = function() {
        if (/^c/.test(doc[readyState])) {
            doc.detachEvent(onreadystatechange, fn)
            flush()
        }
    })

    return (ready = hack ?
    function(fn) {
        self != top ? loaded ? fn() : fns.push(fn) : function() {
            try {
                testEl.doScroll('left')
            } catch (e) {
                return setTimeout(function() {
                    ready(fn)
                }, 50)
            }
            fn()
        }()
    } : function(fn) {
        loaded ? fn() : fns.push(fn)
    })
});</pre>
</body>
</html>
